ALTER SESSION SET CONTAINER=XEPDB1;

CREATE VIEW GRA_USER.kwnfse_header
AS
SELECT hsq720652 AS nfe_id
	,hsq72s100 AS qserv
	,hsq72s101 AS serv_vcred
	,hsq72s102 AS serv_status_nfe
	,hsq72s103 AS serv_trib_nfe
	,hsq72s104 AS serv_opcao_simples
	,hsq72s105 AS serv_numero_guia
	,hsq72s106 AS serv_iss_flag
	,hsq72s107 AS iss_viss
	,hsq72s108 AS serv_vpis
	,hsq72s109 AS serv_vcofins
	,hsq72s110 AS serv_vbcpcc
	,hsq72s111 AS serv_ppcc
	,hsq72s112 AS serv_vpcc
	,hsq72s113 AS serv_vbcinss
	,hsq72s114 AS serv_pinss
	,hsq72s115 AS serv_vinss
	,hsq72s116 AS vbccsll
	,hsq72s117 AS pcsll
	,hsq72c307 AS hemi
	,hsq72s149 AS pirrf
	,hsq72s150 AS cod_verificacao
	,hsq72s151 AS nfse_substituida
	,hsq72s130 AS dt_prest_serv
	,hsq72s152 AS exigibilidade
	,hsq72s153 AS disc_serv
	,hsq72s154 AS vlr_csll
	,hsq72s155 AS vlr_irrf
	,hsq72s156 AS base_calculo
	,hsq72s157 AS aliquota
	,hsq72s158 AS dt_venc
	,hsq72s159 AS serie_recibo
	,hsq72s160 AS tp_recibo
	,hsq72s161 AS dt_emissao
	,hsq72s162 AS art
	,hsq72s163 AS cod_obra
	,hsq72s164 AS vlr_liquido
	,hsq721228 AS vlr_ret_fede
	,hsq72s165 AS mes_compet
	,hsq72s166 AS mun_incid
	,hsq72s167 AS recolhimento
	,hsq72s168 AS tributacao
	,hsq72s169 AS cnae
	,hsq72s170 AS desc_atv
	,hsq72s171 AS local_prest
	,hsq72s172 AS icent_cult
	,hsq72s173 AS dt_pag
	,hsq72s174 AS num_guia
	,hsq72s175 AS item_lista_serv
	,hsq720791 AS alq_cofins
	,hsq720785 AS alq_pis
	,hsq720796 AS alq_iss_ret
	,hsq721231 AS vlr_iss_ret
	,hsq721227 AS vlr_deducoes
	,hsq720731 AS vlr_desconto
	,hsq72s177 AS vlr_out_ret
	,hsq721230 AS dsct_condic
	,hsq721229 AS dsct_incond
	,hsq72s187 AS id
	,hsq72s188 AS reg_trib
	,hsq720863 AS audit_usuario
	,hsq720870 AS audit_programa
	,hsq720881 AS audit_data
	,hsq720874 AS audit_hora
	,hsq72s186 AS audit_maquina
FROM GRA_USER.fq72s300;

CREATE VIEW GRA_USER.kwnfse_imagem
AS
SELECT isq720652 AS nfe_id
	,isq72s185 AS imagem
	,isq720863 AS audit_usuario
	,isq720870 AS audit_programa
	,isq720881 AS audit_data
	,isq720874 AS audit_hora
	,isq72s186 AS audit_maquina
FROM GRA_USER.fq72s304;

CREATE VIEW GRA_USER.kwnfse_itens_servicos
AS
SELECT isq720652 AS nfe_id
	,isq720653 AS nitem
	,isq72s178 AS flag_tributavel
	,isq72s179 AS descricao
	,isq72s180 AS qtde
	,isq72s181 AS vlr_unitario
	,isq72s182 AS vlr_total
	,isq72s189 AS seqitem
	,isq72s190 AS ponumber
	,isq720863 AS audit_usuario
	,isq720870 AS audit_programa
	,isq720881 AS audit_data
	,isq720874 AS audit_hora
	,isq72s186 AS audit_maquina
FROM GRA_USER.fq72s301;

CREATE VIEW GRA_USER.kwnfse_particularidade
AS
SELECT psq720652 AS nfe_id
	,psq72s176 AS particularidades
	,psq720863 AS audit_usuario
	,psq720870 AS audit_programa
	,psq720881 AS audit_data
	,psq720874 AS audit_hora
	,psq72s186 AS audit_maquina
FROM GRA_USER.fq72s303;

CREATE VIEW GRA_USER.kwnfse_pedidos_compra
AS
SELECT pcq720652 AS nfe_id
	,pcq720653 AS nitem
	,pcq72s183 AS nro_pedido
	,pcq72s184 AS cod_item
	,pcq720863 AS audit_usuario
	,pcq720870 AS audit_programa
	,pcq720881 AS audit_data
	,pcq720874 AS audit_hora
	,pcq72s186 AS audit_maquina
FROM GRA_USER.fq72s302;

CREATE VIEW GRA_USER.kwnfse_dados_entrega
AS
SELECT deq720652 AS nfe_id
	,deq72s191 AS cnpjtransp
	,deq72s192 AS dtrecebimento
	,deq72s193 AS dtsaida
	,deq72s194 AS assinaturavisivel
	,deq720863 AS audit_usuario
	,deq720870 AS audit_programa
	,deq720881 AS audit_data
	,deq720874 AS audit_hora
	,deq72s186 AS audit_maquina
FROM GRA_USER.fq72s305;

CREATE VIEW GRA_USER.kwnfse_dados_compl
AS
SELECT dcq720652 AS nfe_id
	,dcq72s195 AS remetente
	,dcq72s196 AS tpdoc
	,dcq72s197 AS dtaprovacao
	,dcq72s198 AS usuarioprov
	,dcq72s199 AS textoaprov
	,dcq72s200 AS idocorrencia
	,dcq72s201 AS idprotocolo
	,dcq720863 AS audit_usuario
	,dcq720870 AS audit_programa
	,dcq720881 AS audit_data
	,dcq720874 AS audit_hora
	,dcq72s186 AS audit_maquina
FROM GRA_USER.fq72s306;

CREATE VIEW GRA_USER.kwnfse
AS
SELECT nfq720652 AS id
	,nfq720702 AS cuf
	,nfq720703 AS cnf
	,nfq720704 AS natop
	,nfq720705 AS indpag
	,nfq720706 AS mmod
	,nfq720707 AS serie
	,nfq720708 AS nnf
	,nfq720709 AS demi
	,nfq720710 AS dsaient
	,nfq720711 AS hsaient
	,nfq720712 AS tpnf
	,nfq720713 AS cmunfg
	,nfq720714 AS tpimp
	,nfq720715 AS tpemis
	,nfq720716 AS cdv
	,nfq720717 AS tpamb
	,nfq720718 AS finnfe
	,nfq720719 AS procemi
	,nfq720720 AS verproc
	,nfq720721 AS dhcont
	,nfq720723 AS xjust
	,nfq720724 AS icms_vbc
	,nfq720725 AS vicms
	,nfq720726 AS vbcst
	,nfq720727 AS vst
	,nfq720728 AS vprod
	,nfq720729 AS vfrete
	,nfq720730 AS vseg
	,nfq720731 AS vdesc
	,nfq720732 AS vii
	,nfq720733 AS vipi
	,nfq720734 AS prod_vpis
	,nfq720735 AS prod_vcofins
	,nfq720736 AS prod_voutro
	,nfq720737 AS vnf
	,nfq720738 AS vserv
	,nfq720739 AS serv_vbc
	,nfq720740 AS iss_viss
	,nfq720741 AS serv_vpis
	,nfq720742 AS serv_vcofins
	,nfq720743 AS vretpis
	,nfq720744 AS vretcofins
	,nfq720745 AS vretcsll
	,nfq720746 AS vbcirrf
	,nfq720747 AS virrf
	,nfq720748 AS vbcretprev
	,nfq720749 AS vretprev
	,nfq720750 AS modfrete
	,nfq720751 AS rettransp_vserv
	,nfq720752 AS rettransp_vbcret
	,nfq720753 AS rettransp_picmsret
	,nfq720754 AS rettransp_vicmsret
	,nfq720755 AS rettransp_cfop
	,nfq720756 AS rettransp_cmunfg
	,nfq720757 AS placa
	,nfq720758 AS placa_uf
	,nfq720759 AS rntc
	,nfq720760 AS fat_nfat
	,nfq720761 AS fat_vorig
	,nfq720762 AS fat_vdesc
	,nfq720763 AS fat_vliq
	,nfq720764 AS infadfisco
	,nfq720765 AS infcpl
	,nfq720766 AS ufembarq
	,nfq720767 AS xlocembarq
	,nfq720768 AS xnemp
	,nfq720769 AS xped
	,nfq720770 AS xcont
	,nfq721201 AS dhemi
	,nfq721202 AS dhsaient
	,nfq721203 AS iddest
	,nfq721204 AS indfinal
	,nfq721205 AS indpres
	,nfq721240 AS vicmsdeson
	,nfq721241 AS dcompet
	,nfq721242 AS vdeducao
	,nfq721243 AS voutro
	,nfq721244 AS vdescincond
	,nfq721245 AS vdesccond
	,nfq721246 AS vissret
	,nfq721247 AS cregtrib
	,nfq721310 AS vfcpufdest
	,nfq721311 AS vicmsufdest
	,nfq721312 AS vicmsufremet
	,nfq722411 AS vfcp
	,nfq722414 AS vfcpst
	,nfq722417 AS vfcpstret
	,nfq722421 AS vipidevol
FROM GRA_USER.fq72300;

CREATE VIEW GRA_USER.kwnfse_xml
AS
SELECT nxq720652 AS nfe_id
	,nxq720897 AS xml_tipo
	,nxq720653 AS xml_seq
	,nxq720839 AS xml_nfe
	,nxuser AS xml_user
	,nxq72172 AS xml_date
	,nxtime AS xml_time
	,nxq72173 AS xml_jobn
FROM GRA_USER.fq72319;

CREATE VIEW GRA_USER.kwnfse_itens
AS
SELECT niq720652 AS nfe_id
	,niq720653 AS nitem
	,niq720654 AS cprod
	,niq720655 AS cean
	,niq720656 AS xprod
	,niq720657 AS ncm
	,niq720658 AS extipi
	,niq720671 AS genero
	,niq720660 AS cfop
	,niq720661 AS ucom
	,niq720662 AS qcom
	,niq720663 AS vuncom
	,niq720728 AS vprod
	,niq720665 AS ceantrib
	,niq720666 AS utrib
	,niq720667 AS qtrib
	,niq720668 AS vuntrib
	,niq720729 AS vfrete
	,niq720730 AS vseg
	,niq720731 AS vdesc
	,niq720672 AS voutro
	,niq720673 AS indtot
	,niq720769 AS xped
	,niq720675 AS nitemped
	,niq720676 AS orig
	,niq720677 AS icm_cst
	,niq720678 AS icm_modbc
	,niq720679 AS icm_predbc
	,niq720680 AS icm_vbc
	,niq720681 AS icm_picms
	,niq720682 AS icm_vicms
	,niq720683 AS icm_modbcst
	,niq720674 AS icm_pmvast
	,niq720684 AS icm_predbcst
	,niq720685 AS icm_vbcst
	,niq720686 AS icm_picmsst
	,niq720687 AS icm_vicmsst
	,niq720688 AS icm_motdesicms
	,niq720689 AS icm_vbcstret
	,niq720690 AS icm_vicmsstret
	,niq720691 AS icm_pbcop
	,niq720692 AS icm_ufst
	,niq720693 AS icm_vbcstdest
	,niq720694 AS icm_vicmsstdest
	,niq720695 AS icm_csosn
	,niq720696 AS icm_pcredsn
	,niq720697 AS icm_vcredicmssn
	,niq720698 AS ipi_clenq
	,niq720699 AS ipi_cnpjprod
	,niq720700 AS ipi_cselo
	,niq720771 AS ipi_qselo
	,niq720772 AS ipi_cenq
	,niq720773 AS ipi_cst
	,niq720774 AS ipi_vbc
	,niq720775 AS ipi_qunid
	,niq720776 AS ipi_vunid
	,niq720777 AS ipi_pipi
	,niq720778 AS ipi_vipi
	,niq720779 AS ii_vbc
	,niq720780 AS ii_vdespadu
	,niq720781 AS ii_vii
	,niq720782 AS ii_viof
	,niq720783 AS pis_cst
	,niq720784 AS pis_vbc
	,niq720785 AS pis_ppis
	,niq720786 AS pis_qbcprod
	,niq720787 AS pis_valiqprod
	,niq720788 AS pis_vpis
	,niq720789 AS cofins_cst
	,niq720790 AS cofins_vbc
	,niq720791 AS cofins_pcofins
	,niq720792 AS cofins_qbcprod
	,niq720793 AS cofins_valiqprod
	,niq720794 AS cofins_vcofins
	,niq720795 AS iss_vbc
	,niq720796 AS iss_valiq
	,niq720797 AS iss_vissqn
	,niq720798 AS iss_cmunfg
	,niq720799 AS iss_clistserv
	,niq720800 AS iss_csittrib
	,niq721001 AS qtd_fisica
	,niq721002 AS qtd_avariada
	,niq721003 AS cod_motivo
	,niq721004 AS des_motivo
	,niq720801 AS infadprod
	,niq721005 AS user_contagem
	,niq721006 AS data_contagem
	,niq721269 AS nfci
	,niq721222 AS vtottrib
	,niq721223 AS vicmsdeson
	,niq721224 AS vicmsop
	,niq721225 AS pdif
	,niq721226 AS vicmsdif
	,niq721227 AS vdeducao
	,niq721228 AS voutro_ret
	,niq721229 AS vdescincond
	,niq721230 AS vdesccond
	,niq721231 AS vissret
	,niq721232 AS indiss
	,niq721233 AS cservico
	,niq721234 AS cmun
	,niq721235 AS cpais
	,niq721236 AS nprocesso
	,niq721237 AS indincentivo
	,niq721238 AS pdevol
	,niq721239 AS vipidevol
	,niq721268 AS nve
	,niq721270 AS nve2
	,niq721271 AS nve3
	,niq721272 AS nve4
	,niq721273 AS nve5
	,niq721274 AS nve6
	,niq721275 AS nve7
	,niq721276 AS nve8
	,niq721221 AS nrecopi
	,niq721304 AS cest
	,niq721305 AS vbcufdest
	,niq721306 AS pfcpufdest
	,niq721307 AS picmsufdest
	,niq721308 AS picmsinter
	,niq721309 AS picmsinterpart
	,niq721310 AS vfcpufdest
	,niq721311 AS vicmsufdest
	,niq721312 AS vicmsufremet
	,niq722410 AS pfcp
	,niq722411 AS vfcp
	,niq722412 AS vbcfcpst
	,niq722413 AS pfcpst
	,niq722414 AS vfcpst
	,niq722415 AS vbcfcp
	,niq722416 AS pfcpstret
	,niq722417 AS vfcpstret
	,niq722418 AS pst
	,niq722419 AS vbcfcpstret
	,niq722420 AS vbcfcpufdest
	,niq722429 AS indescala
	,niq722430 AS cnpjfab
	,niq722431 AS cbenef
FROM GRA_USER.fq72301;

CREATE VIEW GRA_USER.kwnfse_infcpl
AS
SELECT nfq720652 AS nfe_id
	,nfq720653 AS nitm
	,nfq721200 AS infcpl
FROM GRA_USER.fq72300a;

CREATE VIEW GRA_USER.kwnfse_enderecos
AS
SELECT neq720652 AS nfe_id
	,neq720803 AS ctipo
	,neq720804 AS cnpj
	,neq720805 AS cpf
	,neq720806 AS xnome
	,neq720807 AS xfant
	,neq720808 AS xlgr
	,neq720809 AS nro
	,neq720810 AS xcpl
	,neq720811 AS xbairro
	,neq720812 AS cmun
	,neq720813 AS xmun
	,neq720814 AS uf
	,neq720815 AS cep
	,neq720816 AS cpais
	,neq720817 AS xpais
	,neq720818 AS xender
	,neq720819 AS ie
	,neq720820 AS isuf
	,neq720821 AS iest
	,neq720822 AS im
	,neq720823 AS fone
	,neq720824 AS email
	,neq720825 AS cnae
	,neq720826 AS crt
	,neq721206 AS idestrangeiro
	,neq721207 AS indledest
FROM GRA_USER.fq72302;

CREATE VIEW GRA_USER.kwnfse_controle
AS
SELECT nqq720652 AS nfe_id
	,nqq720841 AS protocolo
	,nqq720708 AS nnf
	,nqq720707 AS serie
	,nqq720804 AS cnpj_emit
	,nqq720814 AS uf_emit
	,nqq720812 AS xmun_emit
	,nqq720842 AS cnpj_dest
	,nqq720854 AS cpf_dest
	,nqq720856 AS uf_dest
	,nqq720813 AS xmun_dest
	,nqq720709 AS demi
	,nqq720961 AS cstatussefaz
	,nqq720833 AS xmotivo
	,nqq720962 AS dtconsultasefaz
	,nqq720963 AS hrconsultasefaz
	,nqq720973 AS arquivo
	,nqq720972 AS dtrecepcao
	,nqq720966 AS dtentrada
	,nqq720967 AS hrentrada
	,nqq720968 AS userentrada
	,nqq720862 AS ctipovalidacao
	,nqq720980 AS cstatus01
	,nqq720981 AS userchgstatus01
	,nqq720982 AS datechgstatus01
	,nqq720983 AS cstatus02
	,nqq720984 AS userchgstatus02
	,nqq720985 AS datechgstatus02
	,nqq720986 AS cstatus03
	,nqq720987 AS userchgstatus03
	,nqq720988 AS datechgstatus03
	,nqq720989 AS cstatus04
	,nqq720990 AS userchgstatus04
	,nqq720991 AS datechgstatus04
	,nqq720992 AS cstatus05
	,nqq720993 AS userchgstatus05
	,nqq720994 AS datechgstatus05
	,nqq720863 AS audit_usuario
	,nqq720870 AS audit_programa
	,nqq720881 AS audit_data
	,nqq720874 AS audit_hora
	,nqq721100 AS dtcoleta
	,nqq721101 AS cstatus06
	,nqq721102 AS userchgstatus06
	,nqq721103 AS cnpj_transport
	,nqq721104 AS datechgstatus06
	,nqq721105 AS cstatus07
	,nqq721106 AS userchgstatus07
	,nqq721107 AS datechgstatus07
	,nqq721108 AS cstatus08
	,nqq721109 AS userchgstatus08
	,nqq721110 AS datechgstatus08
	,nqq721111 AS cstatus09
	,nqq721112 AS userchgstatus09
	,nqq721113 AS datechgstatus09
	,nqq721114 AS cstatus10
	,nqq721115 AS userchgstatus10
	,nqq721116 AS datechgstatus10
	,nqq721117 AS cstatus11
	,nqq721118 AS userchgstatus11
	,nqq721119 AS datechgstatus11
	,nqq721120 AS cstatus12
	,nqq721121 AS userchgstatus12
	,nqq721122 AS datechgstatus12
	,nqq721123 AS cstatus13
	,nqq721124 AS userchgstatus13
	,nqq721125 AS datechgstatus13
	,nqq721126 AS cstatus14
	,nqq721127 AS userchgstatus14
	,nqq721128 AS datechgstatus14
	,nqq721129 AS cstatus15
	,nqq721130 AS userchgstatus15
	,nqq721131 AS datechgstatus15
	,nqq721132 AS cstatus16
	,nqq721133 AS userchgstatus16
	,nqq721134 AS datechgstatus16
	,nqq721135 AS cstatus17
	,nqq721136 AS userchgstatus17
	,nqq721137 AS datechgstatus17
	,nqq72138 AS cstatus18
	,nqq72139 AS userchgstatus18
	,nqq72140 AS datechgstatus18
	,nqq72141 AS cstatus19
	,nqq72142 AS userchgstatus19
	,nqq72143 AS datechgstatus19
	,nqq72144 AS cstatus20
	,nqq72145 AS userchgstatus20
	,nqq72146 AS datechgstatus20
	,nqq72147 AS dateuser01
	,nqq72148 AS dateuser02
	,nqq72149 AS dateuser03
	,nqq72150 AS dateuser04
	,nqq72151 AS dateuser05
	,nqq721138 AS strguser01
	,nqq721139 AS strguser02
	,nqq72152 AS strguser03
	,nqq72153 AS strguser04
	,nqq72154 AS strguser05
	,nqq72155 AS numbuser01
	,nqq72156 AS numbuser02
	,nqq72157 AS numbuser03
	,nqq72158 AS numbuser04
	,nqq72159 AS numbuser05
	,nqq72160 AS tiponfe
	,nqq721003 AS cod_motivo
	,nqq72161 AS coment_motivo
	,nqq72162 AS statusnfe
	,nqq72163 AS autorinfe
	,nqq72164 AS qtysum
	,nqq72165 AS vlrnf
	,nqq72166 AS umedida
	,nqq72167 AS comercial
	,nqq72168 AS filial
	,nqq72169 AS dtentrprevista
	,nqq72170 AS hrentrprevista
	,nqq72171 AS codigoerp
	,nqq721173 AS canc_prot
	,nqq721174 AS canc_id
	,nqq721175 AS canc_motivo
	,nqq721176 AS canc_data
	,nqq721177 AS canc_hora
FROM GRA_USER.fq72317;
